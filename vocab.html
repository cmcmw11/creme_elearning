<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå - Creme E-Learning</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <style>
    /* CSS ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô */
    /* ... ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡πâ‡∏ô ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ã‡πâ‡∏≥‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ô‡∏µ‡πâ (‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡∏ä‡∏∏‡∏î CSS ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢) */
  </style>
</head>
<body>
  <div class="container">
    <header>üìñ ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</header>

    <div class="search-container">
      <input type="text" id="searchInput" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå..." oninput="filterBySearch()">
    </div>

    <div class="filter">
      <label for="az">‡∏Å‡∏£‡∏≠‡∏á A-Z: </label>
      <select id="az" onchange="filterAZ()">
        <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
        ${"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split('').map(l => `<option value="${l}">${l}</option>`).join('')}
      </select>
    </div>

    <div class="cards" id="cardContainer">
      <!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏î‡∏¢ JavaScript -->
    </div>

    <div class="home-container">
      <button class="home-btn" onclick="window.location.href='index.html'">
        üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
      </button>
    </div>
  </div>

  <script>
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏û‡∏π‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á
    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      window.speechSynthesis.speak(utterance);
    }

    // ‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
    function filterBySearch() {
      const input = document.getElementById('searchInput').value.toLowerCase();
      const cards = Array.from(document.querySelectorAll('.card'));

      let found = false;

      cards.forEach((card, index) => {
        const word = (card.dataset.word || '').toLowerCase();
        if (!found && word.startsWith(input)) {
          found = true;
          cards.forEach((c, i) => {
            c.style.display = i >= index ? 'block' : 'none';
          });

          setTimeout(() => {
            card.scrollIntoView({ behavior: 'smooth', block: 'start' });
            card.style.border = '3px dashed hotpink';
            setTimeout(() => card.style.border = '2px solid #ffd6de', 1500);
          }, 100);
        }
      });

      if (!found) {
        cards.forEach(card => card.style.display = 'none');
      }
    }

    // ‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå A-Z
    function filterAZ() {
      const selected = document.getElementById('az').value.toLowerCase();
      const cards = document.querySelectorAll('.card');

      cards.forEach(card => {
        const word = card.dataset.word.toLowerCase();
        card.style.display = selected === "" || word.startsWith(selected) ? 'block' : 'none';
      });
    }

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å CSV
    function loadCSVData() {
      fetch('vocabulary.csv')
        .then(response => {
          if (!response.ok) throw new Error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå CSV");
          return response.text();
        })
        .then(csv => {
          const result = Papa.parse(csv, {
            header: true,
            skipEmptyLines: true
          });

          const container = document.getElementById('cardContainer');
          container.innerHTML = ""; // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡πà‡∏≠‡∏ô

          result.data.forEach(row => {
            const { word, translation, pos, sentence, sentenceTranslation } = row;
            const card = document.createElement('div');
            card.className = 'card';
            card.dataset.word = word;

            card.innerHTML = `
              <div class="word">${word}</div>
              <div class="type">${pos}</div>
              <div class="meaning">${translation}</div>
              <div class="example">${sentence}<br><span style="color:#999">${sentenceTranslation}</span></div>
              <div class="sound">
                <button onclick="speak('${word}')">üîä ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</button>
                <button onclick="speak('${sentence}')">üîà ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ</button>
              </div>
            `;

            container.appendChild(card);
          });
        })
        .catch(err => {
          console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:', err);
          document.getElementById('cardContainer').innerHTML =
            '<p style="color:red; text-align:center;">‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå vocabulary.csv</p>';
        });
    }

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
    function checkLogin() {
      if (!localStorage.getItem("loggedIn") && !sessionStorage.getItem("loggedIn")) {
        window.location.href = "login.html";
      }
    }

    window.onload = function () {
      checkLogin();
      loadCSVData();
    };
  </script>
</body>
</html>
